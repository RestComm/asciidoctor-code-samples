from http.client import HTTPSConnection
from base64 import b64encode
from urllib.parse import urlencode

# Change 'mycompany' to the desired restcomm organization
restcomm_domain = 'mycompany.restcomm.com'
# Provide your Account Sid and Auth Token from your Console Account page
account_sid = 'YourAccountSid'
auth_token = 'YourAuthToken'

userAndPass = b64encode(bytes(account_sid + ':' + auth_token, 'utf-8')).decode("ascii")
headers = { 'Authorization' : 'Basic %s' %  userAndPass,
            'Content-type': 'application/x-www-form-urlencoded',
            'Accept': 'text/plain' }

# Update POST parameters accordingly
params = urlencode({
${attrs.normalizedPostParameters}
})

conn = HTTPSConnection(restcomm_domain)
conn.request("${attrs.httpMethod}", '/restcomm/2012-04-24/${attrs.urlSuffix}',
      params, headers=headers)
res = conn.getresponse()

print(res.status, res.reason)

# Response text
data = res.read()

conn.close()
